<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Exploratory Data Analysis | Omics Central</title>
  <meta name="description" content="This book covers some commonly used to explore and analyze omics data." />
  <meta name="generator" content="bookdown 0.17.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Exploratory Data Analysis | Omics Central" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book covers some commonly used to explore and analyze omics data." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Exploratory Data Analysis | Omics Central" />
  
  <meta name="twitter:description" content="This book covers some commonly used to explore and analyze omics data." />
  

<meta name="author" content="Amrit Singh" />


<meta name="date" content="2020-01-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-types.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Omics Central</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Rationale</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="data-types.html"><a href="data-types.html"><i class="fa fa-check"></i><b>3</b> Data-types</a><ul>
<li class="chapter" data-level="3.1" data-path="data-types.html"><a href="data-types.html#microarrays"><i class="fa fa-check"></i><b>3.1</b> Microarrays</a></li>
<li class="chapter" data-level="3.2" data-path="data-types.html"><a href="data-types.html#rna-sequencing"><i class="fa fa-check"></i><b>3.2</b> RNA sequencing</a></li>
<li class="chapter" data-level="3.3" data-path="data-types.html"><a href="data-types.html#nanostring"><i class="fa fa-check"></i><b>3.3</b> Nanostring</a></li>
<li class="chapter" data-level="3.4" data-path="data-types.html"><a href="data-types.html#biocrates"><i class="fa fa-check"></i><b>3.4</b> Biocrates</a></li>
<li class="chapter" data-level="3.5" data-path="data-types.html"><a href="data-types.html#multiple-reaction-monitoring"><i class="fa fa-check"></i><b>3.5</b> Multiple Reaction Monitoring</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>4</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="eda.html"><a href="eda.html#principal-component-analysis"><i class="fa fa-check"></i><b>4.1</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="4.1.1" data-path="eda.html"><a href="eda.html#method"><i class="fa fa-check"></i><b>4.1.1</b> Method</a></li>
<li class="chapter" data-level="4.1.2" data-path="eda.html"><a href="eda.html#visualizations"><i class="fa fa-check"></i><b>4.1.2</b> Visualizations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>5</b> References</a></li>
<li class="chapter" data-level="6" data-path="batch-correction.html"><a href="batch-correction.html"><i class="fa fa-check"></i><b>6</b> Batch Correction</a><ul>
<li class="chapter" data-level="6.1" data-path="batch-correction.html"><a href="batch-correction.html#combat"><i class="fa fa-check"></i><b>6.1</b> ComBat</a></li>
<li class="chapter" data-level="6.2" data-path="batch-correction.html"><a href="batch-correction.html#surrogate-variable-analysis"><i class="fa fa-check"></i><b>6.2</b> Surrogate Variable Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="batch-correction.html"><a href="batch-correction.html#model-adjustment"><i class="fa fa-check"></i><b>6.3</b> Model adjustment</a></li>
<li class="chapter" data-level="6.4" data-path="batch-correction.html"><a href="batch-correction.html#references-1"><i class="fa fa-check"></i><b>6.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="diff-exp.html"><a href="diff-exp.html"><i class="fa fa-check"></i><b>7</b> Differential Expression Analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="diff-exp.html"><a href="diff-exp.html#ordinary-least-squares"><i class="fa fa-check"></i><b>7.1</b> Ordinary Least Squares</a></li>
<li class="chapter" data-level="7.2" data-path="diff-exp.html"><a href="diff-exp.html#linear-models-for-microarrays-and-rna-seq"><i class="fa fa-check"></i><b>7.2</b> LInear Models for MicroArrays and RNA-Seq</a><ul>
<li class="chapter" data-level="7.2.1" data-path="diff-exp.html"><a href="diff-exp.html#robust-limma"><i class="fa fa-check"></i><b>7.2.1</b> Robust LIMMA</a></li>
<li class="chapter" data-level="7.2.2" data-path="diff-exp.html"><a href="diff-exp.html#limma-voom"><i class="fa fa-check"></i><b>7.2.2</b> LIMMA VOOM</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="diff-exp.html"><a href="diff-exp.html#significance-analysis-for-microarrays-sam"><i class="fa fa-check"></i><b>7.3</b> Significance Analysis for Microarrays (SAM)</a></li>
<li class="chapter" data-level="7.4" data-path="diff-exp.html"><a href="diff-exp.html#cell-specific-analysis-for-microarrays-cssam"><i class="fa fa-check"></i><b>7.4</b> cell-specific Analysis for Microarrays (csSAM)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="network-analysis.html"><a href="network-analysis.html"><i class="fa fa-check"></i><b>8</b> Network Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="network-analysis.html"><a href="network-analysis.html#dingo"><i class="fa fa-check"></i><b>8.1</b> DINGO</a></li>
<li class="chapter" data-level="8.2" data-path="network-analysis.html"><a href="network-analysis.html#wgcna"><i class="fa fa-check"></i><b>8.2</b> WGCNA</a></li>
<li class="chapter" data-level="8.3" data-path="network-analysis.html"><a href="network-analysis.html#panda"><i class="fa fa-check"></i><b>8.3</b> PANDA</a></li>
<li class="chapter" data-level="8.4" data-path="network-analysis.html"><a href="network-analysis.html#bionetstat"><i class="fa fa-check"></i><b>8.4</b> BioNetStat</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-integration.html"><a href="data-integration.html"><i class="fa fa-check"></i><b>9</b> Data Integration</a><ul>
<li class="chapter" data-level="9.1" data-path="data-integration.html"><a href="data-integration.html#supervised"><i class="fa fa-check"></i><b>9.1</b> Supervised</a><ul>
<li class="chapter" data-level="9.1.1" data-path="data-integration.html"><a href="data-integration.html#diablo-sgccda"><i class="fa fa-check"></i><b>9.1.1</b> DIABLO (SGCCDA)</a></li>
<li class="chapter" data-level="9.1.2" data-path="data-integration.html"><a href="data-integration.html#ensemble-of-glmnet-classifiers"><i class="fa fa-check"></i><b>9.1.2</b> Ensemble of glmnet classifiers</a></li>
<li class="chapter" data-level="9.1.3" data-path="data-integration.html"><a href="data-integration.html#diablo2-smb-plsda"><i class="fa fa-check"></i><b>9.1.3</b> DIABLO2 (sMB-PLSDA)</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="data-integration.html"><a href="data-integration.html#references-2"><i class="fa fa-check"></i><b>9.2</b> References</a></li>
<li class="chapter" data-level="9.3" data-path="data-integration.html"><a href="data-integration.html#unsupervised"><i class="fa fa-check"></i><b>9.3</b> Unsupervised</a><ul>
<li class="chapter" data-level="9.3.1" data-path="data-integration.html"><a href="data-integration.html#panda-1"><i class="fa fa-check"></i><b>9.3.1</b> PANDA</a></li>
<li class="chapter" data-level="9.3.2" data-path="data-integration.html"><a href="data-integration.html#mofa"><i class="fa fa-check"></i><b>9.3.2</b> MOFA</a></li>
<li class="chapter" data-level="9.3.3" data-path="data-integration.html"><a href="data-integration.html#jive"><i class="fa fa-check"></i><b>9.3.3</b> JIVE</a></li>
<li class="chapter" data-level="9.3.4" data-path="data-integration.html"><a href="data-integration.html#snf"><i class="fa fa-check"></i><b>9.3.4</b> SNF</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bio-enrichment.html"><a href="bio-enrichment.html"><i class="fa fa-check"></i><b>10</b> Biological Enrichment</a><ul>
<li class="chapter" data-level="10.1" data-path="bio-enrichment.html"><a href="bio-enrichment.html#enrichr"><i class="fa fa-check"></i><b>10.1</b> Enrichr</a></li>
<li class="chapter" data-level="10.2" data-path="bio-enrichment.html"><a href="bio-enrichment.html#sear"><i class="fa fa-check"></i><b>10.2</b> SEAR</a></li>
<li class="chapter" data-level="10.3" data-path="bio-enrichment.html"><a href="bio-enrichment.html#camera"><i class="fa fa-check"></i><b>10.3</b> CAMERA</a></li>
<li class="chapter" data-level="10.4" data-path="bio-enrichment.html"><a href="bio-enrichment.html#network-based-gene-set-analysis"><i class="fa fa-check"></i><b>10.4</b> Network-based Gene Set Analysis</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lit.html"><a href="lit.html"><i class="fa fa-check"></i><b>11</b> Literature Mining</a></li>
<li class="chapter" data-level="" data-path="references-3.html"><a href="references-3.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Omics Central</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="eda" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Exploratory Data Analysis</h1>
<iframe width="560" height="2" src frameborder="0" allowfullscreen>
</iframe>
<p>//TODO insert video of EDA using Omics Central here</p>
<div id="principal-component-analysis" class="section level2">
<h2><span class="header-section-number">4.1</span> Principal Component Analysis</h2>
<div id="method" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Method</h3>
<div id="what-is-pca" class="section level4">
<h4><span class="header-section-number">4.1.1.1</span> What is PCA?</h4>
<ul>
<li>method to turn a dataset with correlated variables into another dataset with linearly uncorrelated variables called principal components (PCs).</li>
</ul>
</div>
<div id="why-is-pca-useful" class="section level4">
<h4><span class="header-section-number">4.1.1.2</span> Why is PCA useful?</h4>
<ul>
<li>The first few PCs capture most of the variability in the data.</li>
<li>PCA can be used to visualize clustering patterns (samples or variables) in the data, determine relationships between samples (see Principal Component plot), between variables (see Correlation circle), between samples and variables (see Biplot).</li>
<li>PCA is also useful in determining the influece of covariates, both techincal (<em>e.g.</em> batch effects) or biological (<em>e.g.</em> sex).</li>
</ul>
</div>
<div id="what-is-a-principal-component-pc" class="section level4">
<h4><span class="header-section-number">4.1.1.3</span> What is a principal component (PC)?</h4>
<ul>
<li>a PC is a weighted average of the original predictors, <strong>PC</strong><sub><em>i</em></sub> = <strong>Xv</strong><sub><em>i</em></sub>, where <strong>X</strong> is a centered matrix and <em>i=1,…,n</em>.</li>
</ul>
</div>
<div id="what-do-the-vector-of-weights-vi-do" class="section level4">
<h4><span class="header-section-number">4.1.1.4</span> What do the vector of weights <strong>v</strong><sub><em>i</em></sub> do?</h4>
<ul>
<li><em>v<sub>i</sub></em> maximizes the variance; <strong>X<sup>T</sup>X</strong> and are called eigenvectors, weights or loadings.</li>
</ul>
</div>
<div id="how-do-i-compute-the-vector-of-weights-vi" class="section level4">
<h4><span class="header-section-number">4.1.1.5</span> How do I compute the vector of weights, <em>v<sub>i</sub></em>?</h4>
<ul>
<li>apply a factorization method called singular value decomposition (SVD). SVD decomposes a matrix X into a product of 3 matrices, <strong>UDV<sup>T</sup></strong>; <strong>X</strong><sub><em>np</em></sub> = <strong>U</strong><sub><em>nxp</em></sub> x <strong>D</strong>~<em>pxp~</em> x <strong>V<sup>T</sup></strong><sub><em>pp</em></sub> or <strong>X<sup>T</sup>X</strong> = <strong>VD<sup>2</sup>V<sup>T</sup></strong>.</li>
<li>The columns of <strong>V</strong> are the weights/loadings for each principal component.</li>
<li><strong>D</strong> is a diagnoal matrix where entry <strong>D</strong><sub><em>i,i</em></sub> is the standard deviation of the <em>ith</em> principal component (PC).</li>
<li>Only the first <em>k</em> PCs are needed to capture the majority of the variation in the high dimensional dataset (<em>n</em> &lt;&lt; <em>p</em> and <em>k</em> &lt;&lt; <em>p</em>); <strong>X</strong><sub><em>nk</em></sub> = <strong>U</strong><sub><em>nxk</em></sub> x <strong>D</strong><sub><em>pxk</em></sub> x <strong>V<sup>T</sup></strong><sub><em>nk</em></sub> such that <strong>X</strong><sub><em>nk</em></sub> <span class="math inline">\(\approx\)</span> <strong>X</strong><sub><em>np</em></sub>.</li>
</ul>
</div>
<div id="why-scale-the-data-before-applying-pca" class="section level4">
<h4><span class="header-section-number">4.1.1.6</span> Why scale the data before applying PCA?</h4>
<ul>
<li>The clinical variables are on different unit scales (<em>e.g.</em> Age (years) <em>vs.</em> Ejection fraction (%)). Scaling makes the mean of each variable zero and the standard deviation one.</li>
</ul>
<p>References<br />
1. page 64-66 from ESL: <a href="https://web.stanford.edu/~hastie/ElemStatLearn/printings/ESLII_print10.pdf" class="uri">https://web.stanford.edu/~hastie/ElemStatLearn/printings/ESLII_print10.pdf</a><br />
2. Wikipedia: <a href="https://en.wikipedia.org/wiki/Principal_component_analysis" class="uri">https://en.wikipedia.org/wiki/Principal_component_analysis</a></p>
</div>
</div>
<div id="visualizations" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Visualizations</h3>
<div id="scree-plot" class="section level4">
<h4><span class="header-section-number">4.1.2.1</span> Scree plot</h4>
<ul>
<li>determine the proportion of variation explained by each principal component.</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<blockquote>
<p>The barplot depicts the proportion of variation that is captured by the first five PCs; the first PC captures ~30.9% of the variability in the dataset consisting of 65 variables.</p>
</blockquote>
</div>
<div id="component-plot" class="section level4">
<h4><span class="header-section-number">4.1.2.2</span> Component plot</h4>
<ul>
<li>visualize the clustering of the samples and identify any clustering with respect to covariates of interest.</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<blockquote>
<p>The scatter plot above is a 2D depiction of a 65 (# of clinical variables) dimensional dataset. PC1 and PC2 together capture 40% of the variability in the clinical dataset. Some separation between the groups of interest can be observed.</p>
</blockquote>
</div>
<div id="correlation-circle" class="section level4">
<h4><span class="header-section-number">4.1.2.3</span> Correlation Circle</h4>
<ul>
<li><p>determine relationship between variables (based on the correlation between each variable and PCs).</p></li>
<li>the angle (<span class="math inline">\(\theta\)</span>) between two vectors determines the correlation between the two variables:<br />
</li>
<li><span class="math inline">\(\theta\)</span>=0: postive correlation (corr=1)<br />
</li>
<li>0&lt;<span class="math inline">\(\theta\)</span>&lt;90: postive correlation<br />
</li>
<li><span class="math inline">\(\theta\)</span>=90: zero correlation<br />
</li>
<li>90&lt;<span class="math inline">\(\theta\)</span>&lt;180: negative correlation<br />
</li>
<li><p><span class="math inline">\(\theta\)</span>=180: negative correlation (corr=-1)</p></li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="correlation-circle-with-a-cut-off" class="section level4">
<h4><span class="header-section-number">4.1.2.4</span> Correlation Circle (with a cut-off)</h4>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<blockquote>
<p>The above plot only displays the variables if they have a correlation greater than 0.5 with either PC1 or PC2. Ischemia and Statins are positively correlated suggesting that patients with ischemia are likely to be on statins. BNP (Brain Natriuretic Peptide) is positively correlated with age and negatively correlated with Heart Rate.</p>
</blockquote>
<p>References<br />
1. Figure 1 from BioData Mining volume 5, Article number: 19 (2012)<br />
2. plotVar(): mixOmics R-library 3. fviz_pca_var(): factoextra R-library</p>
</div>
<div id="biplot" class="section level4">
<h4><span class="header-section-number">4.1.2.5</span> Biplot</h4>
<ul>
<li>superimpose the principal components with loadings vectors.</li>
</ul>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<blockquote>
<p>Each arrow can be thought of as an axis. For example, BNP points to the left which means that patients on the left (PC1 &lt; 0) have lower BNP levels than patients on the right (PC1 &gt; 0). Patients at the center (PC=1) have an average BNP level. Note that this aligns well with the hospitalization status; <em>ie.</em> patients on the left are more likely to be hospitalized as compared to patients on the right.</p>
</blockquote>
<p>References<br />
1. ggbiplot(): <a href="https://github.com/vqv/ggbiplot" class="uri">https://github.com/vqv/ggbiplot</a><br />
2. Biplot: <a href="https://stackoverflow.com/questions/6578355/plotting-pca-biplot-with-ggplot2" class="uri">https://stackoverflow.com/questions/6578355/plotting-pca-biplot-with-ggplot2</a><br />
3. biplot(): K. R. Gabriel (1971). The biplot graphical display of matrices with application to principal component analysis. Biometrika, 58, 453–467. doi: 10.2307/2334381.<br />
4. fviz_pca_biplot(): <a href="http://www.sthda.com/english/wiki/fviz-pca-quick-principal-component-analysis-data-visualization-r-software-and-data-mining" class="uri">http://www.sthda.com/english/wiki/fviz-pca-quick-principal-component-analysis-data-visualization-r-software-and-data-mining</a></p>
</div>
<div id="are-the-major-sources-of-variation-in-the-proteomics-dataset-related-to-any-demographics-variables" class="section level4">
<h4><span class="header-section-number">4.1.2.6</span> Are the major sources of variation in the proteomics dataset related to any demographics variables?</h4>
<ul>
<li>this is often answers by correlating the PCs with demographics variables such as batch or disease of interest.</li>
</ul>
<div id="test-the-pearson-correlation-between-pcs-and-demographic-variables" class="section level5">
<h5><span class="header-section-number">4.1.2.6.1</span> Test the Pearson correlation between PCs and demographic variables</h5>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="test-the-spearman-correlation-between-pcs-and-demographic-variables" class="section level5">
<h5><span class="header-section-number">4.1.2.6.2</span> Test the Spearman correlation between PCs and demographic variables</h5>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<blockquote>
<p>The associtation between PC1 and BNP has a p-value of &lt; 0.01 which supports the Biplot in which BNP was parallel to PC1 (x-axis).</p>
</blockquote>
<p><strong>WARNING</strong>: This is only to be used for exploratory purposes and not for inference since spurious correlations may arise.</p>
</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-eda.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
